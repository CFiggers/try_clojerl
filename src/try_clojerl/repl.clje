(ns try-clojerl.repl)

(defn init
  [req state]
  (let* [#erl[:ok body req] (cowboy_req/read_body.e req)
         result (try (eval (read-string body))
                  (catch _ e e))
         resp-body (pr-str result)
         req (cowboy_req/reply.e 200 #erl{} resp-body req)]
    #erl[:ok req state]))
